version: 0
platforms:
  - Linux x86_64
  - Linux arm64
from:
  language: c
  shared: 'libglib-2.0.so'
  headers:
    - ../shared/glib/glib/glib.h
  includedirs:
    - ../stdinc/
    - ../shared/glib/
    - ../shared/glib/_build/glib
    - ../shared/glib/_build/
  defines:
    GLIB_COMPILATION: 1
    GLIB_DISABLE_DEPRECATION_WARNINGS: 1
  load_all_includes: true
  extern:
    - "../stdinc/*"
  overwrite:
    functions: &any_function_overwrites
      g_assertion_message_cmpint.param.8.type: 'gchar'
      g_assertion_message_cmpnum.param.8.type: 'gchar'
    types: &any_type_overwrites
      gint8: '#SInt8'
      guint8: '#UInt8'
      gint16: '#SInt16'
      guint16: '#UInt16'
      gint32: '#SInt32'
      guint32: '#UInt32'
      gint64: '#SInt64'
      guint64: '#UInt64'

      _GDoubleIEEE754: 'gdouble'
      _GFloatIEEE754: 'gfloat'
      _GDate: '#UInt8 #Attr Arr 8 #AttrEnd'
      GMainContextPusher: '#RawPtr'
      GMutexLocker: '#RawPtr'
      GRecMutexLocker: '#RawPtr'
      GRWLockWriterLocker: '#RawPtr'
      GRWLockReaderLocker: '#RawPtr'

      GRefString: 'gchar'
  overwrite.linux.x86_64: &overwrites_64
    functions:
      <<: *any_function_overwrites
    types:
      gssize: '#SInt64'
      gsize: '#UInt64'
      goffset: 'gint64'
      gintptr: '#SInt64'
      guintptr: '#UInt64'
      <<: *any_type_overwrites
  overwrite.linux.arm64:
    <<: *overwrites_64
  overwrite.windows.x86_64:
    <<: *overwrites_64
  overwrite.windows.arm64:
    <<: *overwrites_64
  overwrite.linux.x86: &overwrites_32
    functions:
      <<: *any_function_overwrites
    types:
      gssize: '#SInt32'
      gsize: '#UInt32'
      goffset: 'gint32'
      gintptr: '#SInt32'
      guintptr: '#UInt32'
      <<: *any_type_overwrites
  overwrite.linux.arm32:
    <<: *overwrites_32
  overwrite.windows.x86:
    <<: *overwrites_32
  overwrite.windows.arm32:
    <<: *overwrites_32
  ignore:
    types:
      - _GHookList
      - GHookList
      - _GIOChannel
      - GIOChannel
      - _GScannerConfig
      - GScannerConfig
    macros:
      - 'G_*'
      - 'g_*'
to:
  language: odin
  package: glib
  out: glib.odin
  no_build_tag: false
  extern:
    sources:
      "../stdinc/time.h": "core:c/libc"
      "../stdinc/pthread.h": "core:sys/posix"
